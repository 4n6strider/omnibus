#!/usr/bin/env python
##
# omnibus - deadbits
# malware patrol search
##
from http import get

from common import get_apikey


def run(host):
    result = None
    key = get_apikey('malwarepatrol')
    url = 'http://lists.malwarepatrol.net/cgi/getfile?receipt=%s&product=8&list=smoothwall' % key
    headers = {'User-Agent': 'OSINT Omnibus (https://github.com/InQuest/Omnibus)'}

    try:
        status, response = get(url, headers=headers)

        result = {'found': False}
        if status:
            for line in response.content.split('\n'):
                if line.startswith('#') or len(line) > 2:
                    continue

                if line.startswith(host):
                    result['found'] = True

    except:
        pass

    return result
